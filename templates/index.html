<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>eBay Jewelry Scraper</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="{{ url_for('static', filename='js/scripts.js') }}" defer></script>
</head>
<body>
    <div class="container">
        <h1>eBay Jewelry Scraper</h1>
        
        <div class="config-section">
            <h2>Configuration</h2>
            <form id="config-form">
                <label for="output_dir">Output Directory:</label>
                <input type="text" id="output_dir" name="output_dir" value="{{ config.output_dir }}" required>
                
                <label for="max_items">Max Items per Subcategory:</label>
                <input type="number" id="max_items" name="max_items" value="{{ config.max_items }}" min="1" required>
                
                <label for="max_pages">Max Pages per Subcategory:</label>
                <input type="number" id="max_pages" name="max_pages" value="{{ config.max_pages }}" min="1" required>
                
                <h3>Manage Subcategories</h3>
                <div id="categories-container">
                    {% for category in config.categories %}
                        <div class="category">
                            <h4>{{ category.main_class }}</h4>
                            <ul>
                                {% for subcat in category.subcategories %}
                                    <li>
                                        {{ subcat }}
                                        <button type="button" class="remove-subcat" data-main="{{ category.main_class }}" data-sub="{{ subcat }}">Remove</button>
                                    </li>
                                {% endfor %}
                            </ul>
                            <input type="text" class="new-subcat" data-main="{{ category.main_class }}" placeholder="Add new subcategory">
                            <button type="button" class="add-subcat" data-main="{{ category.main_class }}">Add Subcategory</button>
                        </div>
                    {% endfor %}
                </div>
                
                <button type="submit">Update Configuration</button>
            </form>
        </div>
        
        <div class="scrape-section">
            <h2>Start Scraping</h2>
            <form id="scrape-form">
                <label>Select Classes and Subcategories:</label>
                <div id="scrape-classes">
                    {% for category in config.categories %}
                        <div class="scrape-class">
                            <input type="checkbox" class="main-class" data-main="{{ category.main_class }}" id="main-{{ loop.index }}">
                            <label for="main-{{ loop.index }}">{{ category.main_class }}</label>
                            <div class="subcategories">
                                {% for subcat in category.subcategories %}
                                    <input type="checkbox" class="subcat-checkbox" data-main="{{ category.main_class }}" data-sub="{{ subcat }}" id="sub-{{ loop.parent.loop.index }}-{{ loop.index }}">
                                    <label for="sub-{{ loop.parent.loop.index }}-{{ loop.index }}">{{ subcat }}</label><br>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
                <button type="submit">Start Scraping</button>
            </form>
        </div>
        
        <div class="progress-section">
            <h2>Scraping Progress</h2>
            <div id="progress-status">
                <p>Status: <span id="status">Idle</span></p>
                <p>Current Class: <span id="current_class">None</span></p>
                <p>Current Subcategory: <span id="current_subcategory">None</span></p>
                <p>Items Found: <span id="items_found">0</span></p>
                <p>Processed Items: <span id="processed_items">0</span></p>
                <p>Error: <span id="error">None</span></p>
                <p>Current Task: <span id="current_task">None</span></p>
            </div>
            <button id="download-button" style="display:none;">Download Dataset</button>
        </div>
    </div>
</body>
</html>
